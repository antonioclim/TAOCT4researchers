@startuml abm_architecture
!theme plain
skinparam backgroundColor #1a1a2e
skinparam defaultFontColor #e0e0e0
skinparam packageBackgroundColor #16213e
skinparam packageBorderColor #58a6ff

title Agent-Based Model Architecture

package "Core Framework" {
  abstract class Agent {
    -id: int
    -position: tuple[int, int]
    -state: dict
    --
    {abstract} +perceive(environment): Observation
    {abstract} +decide(observation): Action
    {abstract} +act(action): None
    +update(): None
  }
  
  class Environment {
    -grid: NDArray
    -agents: list[Agent]
    -time: int
    --
    +get_neighbours(agent, radius): list[Agent]
    +move_agent(agent, new_pos): bool
    +is_valid_position(pos): bool
    +add_agent(agent): None
    +remove_agent(agent): None
  }
  
  class Simulation {
    -environment: Environment
    -data_collector: DataCollector
    -seed: int
    --
    +step(): None
    +run(n_steps): DataFrame
    +reset(): None
  }
}

package "Schelling Model" {
  class SchellingAgent {
    -agent_type: int
    -tolerance: float
    --
    +is_satisfied(): bool
    +relocate(): None
  }
  
  class SchellingEnvironment {
    -occupancy: float
    --
    +get_empty_cells(): list[tuple]
    +segregation_index(): float
  }
}

package "Boids Model" {
  class Boid {
    -velocity: NDArray
    -max_speed: float
    --
    +separation(neighbours): NDArray
    +alignment(neighbours): NDArray
    +cohesion(neighbours): NDArray
  }
  
  class BoidsEnvironment {
    -width: int
    -height: int
    -wrap: bool
    --
    +order_parameter(): float
  }
}

Agent <|-- SchellingAgent
Agent <|-- Boid
Environment <|-- SchellingEnvironment
Environment <|-- BoidsEnvironment
Simulation o-- Environment
Environment o-- Agent

note right of Agent
  Perceive-Decide-Act cycle
  encapsulates agent behaviour
end note

note bottom of Simulation
  Orchestrates time stepping
  and data collection
end note

@enduml
