<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="layerGrad1" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4a9eff;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#2d7dd2;stop-opacity:0.8"/>
    </linearGradient>
    <linearGradient id="layerGrad2" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#48bb78;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#38a169;stop-opacity:0.8"/>
    </linearGradient>
    <linearGradient id="layerGrad3" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ed8936;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#dd6b20;stop-opacity:0.8"/>
    </linearGradient>
    <linearGradient id="layerGrad4" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9f7aea;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#805ad5;stop-opacity:0.8"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="500" fill="#1a1a2e"/>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" fill="#eaeaea" font-family="Arial, sans-serif" font-size="22" font-weight="bold">Input Validation Layers</text>
  <text x="400" y="55" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="12">Defence in Depth for Research Software</text>
  
  <!-- Input Arrow -->
  <path d="M50,250 L120,250" stroke="#eaeaea" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <text x="85" y="235" text-anchor="middle" fill="#eaeaea" font-family="Arial, sans-serif" font-size="11">Raw Input</text>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#eaeaea"/>
    </marker>
  </defs>
  
  <!-- Layer 1: Type Validation -->
  <g filter="url(#shadow)">
    <rect x="130" y="100" width="140" height="300" rx="10" fill="url(#layerGrad1)"/>
    <text x="200" y="130" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Layer 1</text>
    <text x="200" y="150" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">Type Validation</text>
    <line x1="150" y1="165" x2="250" y2="165" stroke="#fff" stroke-opacity="0.5"/>
    <text x="200" y="190" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">isinstance()</text>
    <text x="200" y="210" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">type hints</text>
    <text x="200" y="230" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">typing.Protocol</text>
    <rect x="145" y="260" width="110" height="60" rx="5" fill="#1a1a2e" fill-opacity="0.3"/>
    <text x="200" y="280" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Raises:</text>
    <text x="200" y="295" text-anchor="middle" fill="#ffd700" font-family="monospace" font-size="9">TypeError</text>
    <text x="200" y="350" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">Fast fail on</text>
    <text x="200" y="365" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">type mismatch</text>
  </g>
  
  <!-- Layer 2: Range Validation -->
  <g filter="url(#shadow)">
    <rect x="290" y="100" width="140" height="300" rx="10" fill="url(#layerGrad2)"/>
    <text x="360" y="130" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Layer 2</text>
    <text x="360" y="150" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">Range/Bounds</text>
    <line x1="310" y1="165" x2="410" y2="165" stroke="#fff" stroke-opacity="0.5"/>
    <text x="360" y="190" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">min_val ≤ x ≤ max</text>
    <text x="360" y="210" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">len() checks</text>
    <text x="360" y="230" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">boundary tests</text>
    <rect x="305" y="260" width="110" height="60" rx="5" fill="#1a1a2e" fill-opacity="0.3"/>
    <text x="360" y="280" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Raises:</text>
    <text x="360" y="295" text-anchor="middle" fill="#ffd700" font-family="monospace" font-size="9">ValueError</text>
    <text x="360" y="350" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">Enforce domain</text>
    <text x="360" y="365" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">constraints</text>
  </g>
  
  <!-- Layer 3: Format Validation -->
  <g filter="url(#shadow)">
    <rect x="450" y="100" width="140" height="300" rx="10" fill="url(#layerGrad3)"/>
    <text x="520" y="130" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Layer 3</text>
    <text x="520" y="150" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">Format/Schema</text>
    <line x1="470" y1="165" x2="570" y2="165" stroke="#fff" stroke-opacity="0.5"/>
    <text x="520" y="190" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">regex patterns</text>
    <text x="520" y="210" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">JSON schema</text>
    <text x="520" y="230" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">dataclass fields</text>
    <rect x="465" y="260" width="110" height="60" rx="5" fill="#1a1a2e" fill-opacity="0.3"/>
    <text x="520" y="280" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Raises:</text>
    <text x="520" y="295" text-anchor="middle" fill="#ffd700" font-family="monospace" font-size="9">ValidationError</text>
    <text x="520" y="350" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">Structural</text>
    <text x="520" y="365" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">integrity</text>
  </g>
  
  <!-- Layer 4: Business Logic -->
  <g filter="url(#shadow)">
    <rect x="610" y="100" width="140" height="300" rx="10" fill="url(#layerGrad4)"/>
    <text x="680" y="130" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Layer 4</text>
    <text x="680" y="150" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">Business Logic</text>
    <line x1="630" y1="165" x2="730" y2="165" stroke="#fff" stroke-opacity="0.5"/>
    <text x="680" y="190" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">invariants</text>
    <text x="680" y="210" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">cross-field</text>
    <text x="680" y="230" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">state consistency</text>
    <rect x="625" y="260" width="110" height="60" rx="5" fill="#1a1a2e" fill-opacity="0.3"/>
    <text x="680" y="280" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Raises:</text>
    <text x="680" y="295" text-anchor="middle" fill="#ffd700" font-family="monospace" font-size="9">DomainError</text>
    <text x="680" y="350" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">Semantic</text>
    <text x="680" y="365" text-anchor="middle" fill="#aaa" font-family="Arial, sans-serif" font-size="9">correctness</text>
  </g>
  
  <!-- Flow arrows between layers -->
  <path d="M270,250 L290,250" stroke="#eaeaea" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M430,250 L450,250" stroke="#eaeaea" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M590,250 L610,250" stroke="#eaeaea" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Output -->
  <path d="M750,250 L780,250" stroke="#48bb78" stroke-width="3" fill="none"/>
  <text x="765" y="235" text-anchor="middle" fill="#48bb78" font-family="Arial, sans-serif" font-size="11">Valid</text>
  <text x="765" y="265" text-anchor="middle" fill="#48bb78" font-family="Arial, sans-serif" font-size="11">Data</text>
  
  <!-- Footer -->
  <text x="400" y="450" text-anchor="middle" fill="#666" font-family="Arial, sans-serif" font-size="10">09UNIT: Exception Handling and Defensive Programming</text>
  <text x="400" y="465" text-anchor="middle" fill="#666" font-family="Arial, sans-serif" font-size="9">Each layer catches specific error categories, providing precise diagnostics</text>
  <text x="400" y="485" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="8">© 2025 Antonio Clim</text>
</svg>
