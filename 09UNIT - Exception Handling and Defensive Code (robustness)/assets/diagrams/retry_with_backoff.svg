<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450">
  <defs>
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16162a"/>
    </linearGradient>
    <linearGradient id="failGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fc8181"/>
      <stop offset="100%" style="stop-color:#f56565"/>
    </linearGradient>
    <linearGradient id="successGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#68d391"/>
      <stop offset="100%" style="stop-color:#48bb78"/>
    </linearGradient>
    <linearGradient id="waitGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4a9eff;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#4a9eff;stop-opacity:0.1"/>
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#eaeaea"/>
    </marker>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="450" fill="url(#bgGrad)"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" fill="#eaeaea" font-family="Arial, sans-serif" font-size="20" font-weight="bold">Retry with Exponential Backoff</text>
  <text x="400" y="50" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="11">delay = base × 2^(attempt-1) × (0.5 + random() × 0.5)</text>
  
  <!-- Timeline axis -->
  <line x1="50" y1="350" x2="750" y2="350" stroke="#444" stroke-width="2"/>
  <text x="400" y="380" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="11">Time →</text>
  
  <!-- Attempt 1 -->
  <g>
    <rect x="70" y="280" width="40" height="60" rx="5" fill="url(#failGrad)"/>
    <text x="90" y="315" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">✗</text>
    <text x="90" y="260" text-anchor="middle" fill="#eaeaea" font-family="Arial, sans-serif" font-size="10">Attempt 1</text>
    <text x="90" y="395" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="9">t=0</text>
  </g>
  
  <!-- Wait 1: 1s -->
  <g>
    <rect x="110" y="300" width="60" height="40" fill="url(#waitGrad)" stroke="#4a9eff" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="140" y="325" text-anchor="middle" fill="#4a9eff" font-family="Arial, sans-serif" font-size="10">1s wait</text>
  </g>
  
  <!-- Attempt 2 -->
  <g>
    <rect x="180" y="280" width="40" height="60" rx="5" fill="url(#failGrad)"/>
    <text x="200" y="315" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">✗</text>
    <text x="200" y="260" text-anchor="middle" fill="#eaeaea" font-family="Arial, sans-serif" font-size="10">Attempt 2</text>
    <text x="200" y="395" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="9">t=1s</text>
  </g>
  
  <!-- Wait 2: 2s -->
  <g>
    <rect x="220" y="290" width="100" height="50" fill="url(#waitGrad)" stroke="#4a9eff" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="270" y="320" text-anchor="middle" fill="#4a9eff" font-family="Arial, sans-serif" font-size="10">2s wait</text>
  </g>
  
  <!-- Attempt 3 -->
  <g>
    <rect x="330" y="280" width="40" height="60" rx="5" fill="url(#failGrad)"/>
    <text x="350" y="315" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">✗</text>
    <text x="350" y="260" text-anchor="middle" fill="#eaeaea" font-family="Arial, sans-serif" font-size="10">Attempt 3</text>
    <text x="350" y="395" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="9">t=3s</text>
  </g>
  
  <!-- Wait 3: 4s -->
  <g>
    <rect x="370" y="280" width="160" height="60" fill="url(#waitGrad)" stroke="#4a9eff" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="450" y="315" text-anchor="middle" fill="#4a9eff" font-family="Arial, sans-serif" font-size="10">4s wait</text>
  </g>
  
  <!-- Attempt 4: Success -->
  <g filter="url(#glow)">
    <rect x="540" y="280" width="40" height="60" rx="5" fill="url(#successGrad)"/>
    <text x="560" y="315" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">✓</text>
    <text x="560" y="260" text-anchor="middle" fill="#48bb78" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Attempt 4</text>
    <text x="560" y="395" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="9">t=7s</text>
  </g>
  
  <!-- Exponential growth illustration -->
  <g>
    <text x="650" y="100" text-anchor="start" fill="#eaeaea" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Backoff Formula</text>
    <line x1="650" y1="110" x2="780" y2="110" stroke="#444"/>
    <text x="650" y="130" fill="#888" font-family="monospace" font-size="10">base = 1.0s</text>
    <text x="650" y="150" fill="#888" font-family="monospace" font-size="10">max_attempts = 5</text>
    <text x="650" y="180" fill="#4a9eff" font-family="monospace" font-size="10">delay₁ = 1.0s</text>
    <text x="650" y="200" fill="#4a9eff" font-family="monospace" font-size="10">delay₂ = 2.0s</text>
    <text x="650" y="220" fill="#4a9eff" font-family="monospace" font-size="10">delay₃ = 4.0s</text>
    <text x="650" y="240" fill="#4a9eff" font-family="monospace" font-size="10">delay₄ = 8.0s</text>
  </g>
  
  <!-- Jitter explanation -->
  <g>
    <rect x="60" y="90" width="200" height="90" rx="8" fill="#2d2d44" stroke="#4a9eff" stroke-width="1"/>
    <text x="160" y="115" text-anchor="middle" fill="#4a9eff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Jitter (Randomisation)</text>
    <text x="70" y="140" fill="#aaa" font-family="Arial, sans-serif" font-size="10">Prevents thundering herd:</text>
    <text x="70" y="160" fill="#888" font-family="monospace" font-size="9">actual = delay × uniform(0.5, 1.0)</text>
  </g>
  
  <!-- Code example -->
  <g>
    <rect x="280" y="90" width="340" height="90" rx="8" fill="#2d2d44" stroke="#444" stroke-width="1"/>
    <text x="290" y="115" fill="#888" font-family="monospace" font-size="9">for attempt in range(1, max_attempts + 1):</text>
    <text x="290" y="130" fill="#888" font-family="monospace" font-size="9">    try:</text>
    <text x="290" y="145" fill="#48bb78" font-family="monospace" font-size="9">        return operation()</text>
    <text x="290" y="160" fill="#888" font-family="monospace" font-size="9">    except TransientError:</text>
    <text x="290" y="175" fill="#f56565" font-family="monospace" font-size="9">        sleep(base * 2**(attempt-1) * jitter)</text>
  </g>
  
  <!-- Footer -->
  <text x="400" y="425" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="9">09UNIT: Exception Handling and Defensive Programming | © 2025 Antonio Clim</text>
</svg>
