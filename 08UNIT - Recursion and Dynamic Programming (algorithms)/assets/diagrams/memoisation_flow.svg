<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="800" height="600">
  <defs>
    <linearGradient id="bgGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
    <linearGradient id="processGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0f3460"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
    <linearGradient id="decisionGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f0883e"/>
      <stop offset="100%" style="stop-color:#b86428"/>
    </linearGradient>
    <linearGradient id="hitGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3fb950"/>
      <stop offset="100%" style="stop-color:#238636"/>
    </linearGradient>
    <linearGradient id="missGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f85149"/>
      <stop offset="100%" style="stop-color:#b33a3a"/>
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3fb950"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f85149"/>
    </marker>
    <filter id="shadow3" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="600" fill="url(#bgGrad3)"/>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" fill="#58a6ff" font-family="Segoe UI, sans-serif" font-size="22" font-weight="bold">
    Memoisation: Cache Lookup Flow
  </text>
  <text x="400" y="58" text-anchor="middle" fill="#8b949e" font-family="Segoe UI, sans-serif" font-size="13">
    Top-down approach with hash-based result storage
  </text>
  
  <!-- Start node -->
  <ellipse cx="400" cy="100" rx="70" ry="25" fill="url(#processGrad)" stroke="#58a6ff" stroke-width="2" filter="url(#shadow3)"/>
  <text x="400" y="105" text-anchor="middle" fill="#e6e6e6" font-family="Segoe UI, sans-serif" font-size="14">
    Function Call
  </text>
  
  <!-- Arrow to key generation -->
  <line x1="400" y1="125" x2="400" y2="160" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Key generation box -->
  <rect x="300" y="165" width="200" height="50" rx="6" fill="url(#processGrad)" stroke="#58a6ff" stroke-width="2" filter="url(#shadow3)"/>
  <text x="400" y="185" text-anchor="middle" fill="#e6e6e6" font-family="Segoe UI, sans-serif" font-size="13">
    Generate Cache Key
  </text>
  <text x="400" y="203" text-anchor="middle" fill="#8b949e" font-family="monospace" font-size="11">
    key = (arg1, arg2, ...)
  </text>
  
  <!-- Arrow to decision -->
  <line x1="400" y1="215" x2="400" y2="260" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Decision diamond -->
  <polygon points="400,265 480,315 400,365 320,315" fill="url(#decisionGrad)" stroke="#f0883e" stroke-width="2" filter="url(#shadow3)"/>
  <text x="400" y="310" text-anchor="middle" fill="#ffffff" font-family="Segoe UI, sans-serif" font-size="13" font-weight="bold">
    key in
  </text>
  <text x="400" y="328" text-anchor="middle" fill="#ffffff" font-family="Segoe UI, sans-serif" font-size="13" font-weight="bold">
    cache?
  </text>
  
  <!-- Cache HIT path (left) -->
  <line x1="320" y1="315" x2="180" y2="315" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <text x="250" y="305" text-anchor="middle" fill="#3fb950" font-family="Segoe UI, sans-serif" font-size="12" font-weight="bold">
    YES (HIT)
  </text>
  
  <!-- Return cached value -->
  <rect x="60" y="285" width="110" height="60" rx="6" fill="url(#hitGrad)" stroke="#3fb950" stroke-width="2" filter="url(#shadow3)"/>
  <text x="115" y="310" text-anchor="middle" fill="#ffffff" font-family="Segoe UI, sans-serif" font-size="12">
    Return
  </text>
  <text x="115" y="328" text-anchor="middle" fill="#ffffff" font-family="monospace" font-size="11">
    cache[key]
  </text>
  
  <!-- Arrow from hit to end -->
  <line x1="115" y1="345" x2="115" y2="520" stroke="#3fb950" stroke-width="2"/>
  <line x1="115" y1="520" x2="340" y2="520" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowGreen)"/>
  
  <!-- Cache MISS path (right) -->
  <line x1="480" y1="315" x2="620" y2="315" stroke="#f85149" stroke-width="2" marker-end="url(#arrowRed)"/>
  <text x="550" y="305" text-anchor="middle" fill="#f85149" font-family="Segoe UI, sans-serif" font-size="12" font-weight="bold">
    NO (MISS)
  </text>
  
  <!-- Compute value -->
  <rect x="630" y="285" width="130" height="60" rx="6" fill="url(#missGrad)" stroke="#f85149" stroke-width="2" filter="url(#shadow3)"/>
  <text x="695" y="310" text-anchor="middle" fill="#ffffff" font-family="Segoe UI, sans-serif" font-size="12">
    Compute result
  </text>
  <text x="695" y="328" text-anchor="middle" fill="#ffffff" font-family="Segoe UI, sans-serif" font-size="11">
    (recursive calls)
  </text>
  
  <!-- Arrow to store -->
  <line x1="695" y1="345" x2="695" y2="390" stroke="#f85149" stroke-width="2" marker-end="url(#arrowRed)"/>
  
  <!-- Store in cache -->
  <rect x="620" y="395" width="150" height="50" rx="6" fill="url(#processGrad)" stroke="#58a6ff" stroke-width="2" filter="url(#shadow3)"/>
  <text x="695" y="415" text-anchor="middle" fill="#e6e6e6" font-family="Segoe UI, sans-serif" font-size="12">
    Store in cache
  </text>
  <text x="695" y="433" text-anchor="middle" fill="#8b949e" font-family="monospace" font-size="11">
    cache[key] = result
  </text>
  
  <!-- Arrow to return -->
  <line x1="695" y1="445" x2="695" y2="520" stroke="#58a6ff" stroke-width="2"/>
  <line x1="695" y1="520" x2="460" y2="520" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- End node -->
  <ellipse cx="400" cy="520" rx="55" ry="25" fill="url(#processGrad)" stroke="#58a6ff" stroke-width="2" filter="url(#shadow3)"/>
  <text x="400" y="525" text-anchor="middle" fill="#e6e6e6" font-family="Segoe UI, sans-serif" font-size="14">
    Return
  </text>
  
  <!-- Legend / Key Insight Box -->
  <g transform="translate(50, 430)">
    <rect x="0" y="0" width="250" height="80" rx="6" fill="#0d1117" stroke="#30363d"/>
    <text x="125" y="20" text-anchor="middle" fill="#58a6ff" font-family="Segoe UI, sans-serif" font-size="12" font-weight="bold">
      Key Insight
    </text>
    <text x="10" y="42" fill="#e6e6e6" font-family="Segoe UI, sans-serif" font-size="11">
      Each unique subproblem is computed
    </text>
    <text x="10" y="58" fill="#e6e6e6" font-family="Segoe UI, sans-serif" font-size="11">
      <tspan fill="#3fb950" font-weight="bold">exactly once</tspan>, then retrieved
    </text>
    <text x="10" y="74" fill="#e6e6e6" font-family="Segoe UI, sans-serif" font-size="11">
      in O(1) for all subsequent calls.
    </text>
  </g>
  
  <!-- Python code example -->
  <g transform="translate(520, 82)">
    <rect x="0" y="0" width="250" height="160" rx="6" fill="#0d1117" stroke="#30363d"/>
    <text x="125" y="18" text-anchor="middle" fill="#58a6ff" font-family="Segoe UI, sans-serif" font-size="11" font-weight="bold">
      Python Implementation
    </text>
    <text x="10" y="38" fill="#79c0ff" font-family="monospace" font-size="10">@lru_cache(maxsize=None)</text>
    <text x="10" y="53" fill="#ff7b72" font-family="monospace" font-size="10">def</text>
    <text x="30" y="53" fill="#d2a8ff" font-family="monospace" font-size="10">fib</text>
    <text x="50" y="53" fill="#e6e6e6" font-family="monospace" font-size="10">(n):</text>
    <text x="20" y="68" fill="#ff7b72" font-family="monospace" font-size="10">if</text>
    <text x="35" y="68" fill="#e6e6e6" font-family="monospace" font-size="10">n &lt;= 1:</text>
    <text x="30" y="83" fill="#ff7b72" font-family="monospace" font-size="10">return</text>
    <text x="68" y="83" fill="#e6e6e6" font-family="monospace" font-size="10">n</text>
    <text x="20" y="98" fill="#ff7b72" font-family="monospace" font-size="10">return</text>
    <text x="55" y="98" fill="#e6e6e6" font-family="monospace" font-size="10">fib(n-1) + fib(n-2)</text>
    <line x1="10" y1="110" x2="240" y2="110" stroke="#30363d"/>
    <text x="10" y="128" fill="#8b949e" font-family="Segoe UI, sans-serif" font-size="10">
      # Or manually:
    </text>
    <text x="10" y="143" fill="#e6e6e6" font-family="monospace" font-size="10">cache = {}</text>
    <text x="10" y="155" fill="#e6e6e6" font-family="monospace" font-size="10">if n in cache: return cache[n]</text>
  </g>
  
  <!-- Footer -->
  <text x="400" y="580" text-anchor="middle" fill="#484f58" font-family="Segoe UI, sans-serif" font-size="11">
    08UNIT — Recursion and Dynamic Programming | © 2026 Antonio Clim
  </text>
</svg>
