<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>02UNIT: Abstraction and Encapsulation | Computational Thinking</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reset.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/theme/night.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/highlight/monokai.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <style>
        :root {
            --r-heading-color: #58a6ff;
            --r-link-color: #79c0ff;
        }
        .reveal h1, .reveal h2 { text-transform: none; }
        .reveal .slides section { text-align: left; }
        
        .hook-box {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-left: 4px solid #e94560;
            padding: 20px 25px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
        }
        .hook-box .source {
            font-size: 0.7em;
            color: #888;
            margin-top: 10px;
            font-style: normal;
        }
        
        .definition-box {
            background: linear-gradient(135deg, #0f3460 0%, #16213e 100%);
            border: 1px solid #58a6ff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
        }
        .definition-box h4 {
            color: #58a6ff;
            margin: 0 0 10px 0;
            font-size: 1em;
        }
        
        .theorem-box {
            background: linear-gradient(135deg, #1a472a 0%, #16213e 100%);
            border: 1px solid #3fb950;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
        }
        .theorem-box h4 {
            color: #3fb950;
            margin: 0 0 10px 0;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #5c2a0a 0%, #16213e 100%);
            border: 1px solid #f85149;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
        }
        .warning-box h4 {
            color: #f85149;
            margin: 0 0 10px 0;
        }
        
        .diagram-box {
            background: #0d1117;
            border: 1px solid #30363d;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.65em;
            line-height: 1.4;
            overflow-x: auto;
        }
        
        .two-columns { display: flex; gap: 40px; }
        .two-columns > div { flex: 1; }
        
        .highlight-text { color: #ffa657; font-weight: bold; }
        .small-text { font-size: 0.75em; color: #8b949e; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.8em;
        }
        th, td {
            border: 1px solid #30363d;
            padding: 10px;
            text-align: left;
        }
        th {
            background: #161b22;
            color: #58a6ff;
        }
        tr:nth-child(even) { background: #0d1117; }
        
        .math-display {
            text-align: center;
            margin: 20px 0;
            font-size: 1.1em;
        }
        
        .code-evolution {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }
        .code-evolution .arrow {
            font-size: 2em;
            color: #58a6ff;
        }
        
        .progress-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }
        .progress-dots .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #30363d;
        }
        .progress-dots .dot.filled {
            background: #58a6ff;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /* RESPONSIVE DESIGN â€” BREAKPOINTS                                  */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        /* Mobile devices (portrait) */
        @media (max-width: 480px) {
            .reveal h1 { font-size: 1.5em; }
            .reveal h2 { font-size: 1.2em; }
            .reveal h3 { font-size: 1em; }
            .reveal p, .reveal li { font-size: 0.85em; }
            
            .two-columns {
                flex-direction: column;
                gap: 20px;
            }
            
            .diagram-box {
                font-size: 0.5em;
                padding: 10px;
            }
            
            pre code {
                font-size: 0.65em !important;
            }
            
            .definition-box, .theorem-box, .warning-box, .hook-box {
                padding: 12px;
                margin: 10px 0;
            }
            
            table {
                font-size: 0.65em;
            }
            
            th, td {
                padding: 5px;
            }
        }
        
        /* Tablets (portrait) */
        @media (min-width: 481px) and (max-width: 768px) {
            .reveal h1 { font-size: 1.8em; }
            .reveal h2 { font-size: 1.4em; }
            
            .two-columns {
                flex-direction: column;
                gap: 25px;
            }
            
            .diagram-box {
                font-size: 0.55em;
            }
            
            pre code {
                font-size: 0.7em !important;
            }
        }
        
        /* Tablets (landscape) and small laptops */
        @media (min-width: 769px) and (max-width: 1024px) {
            .diagram-box {
                font-size: 0.6em;
            }
            
            pre code {
                font-size: 0.75em !important;
            }
        }
        
        /* Large screens and projectors */
        @media (min-width: 1440px) {
            .reveal h1 { font-size: 2.5em; }
            .reveal h2 { font-size: 1.8em; }
            .reveal p, .reveal li { font-size: 1.1em; }
            
            .diagram-box {
                font-size: 0.75em;
            }
            
            pre code {
                font-size: 0.9em !important;
            }
        }
        
        /* Print styles for handouts */
        @media print {
            .reveal .slides section {
                page-break-after: always;
            }
            
            .fragment {
                opacity: 1 !important;
                visibility: visible !important;
            }
            
            .definition-box, .theorem-box, .warning-box {
                border-width: 2px;
            }
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- TITLE SLIDE -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section data-background-gradient="linear-gradient(135deg, #0d1117 0%, #161b22 100%)">
                <h1 style="font-size: 2em;">ğŸ”® 02UNIT</h1>
                <h2 style="color: #58a6ff; font-size: 1.5em;">ABSTRACTION AND ENCAPSULATION</h2>
                <p style="color: #8b949e; font-size: 0.9em;">
                    Functions as Contracts â€¢ Types as Propositions â€¢ Polymorphism
                </p>
                <hr style="border-color: #30363d; margin: 30px 0;">
                <p style="font-size: 0.7em; color: #8b949e;">
                    THE ART OF COMPUTATIONAL THINKING FOR RESEARCHERS<br>
                    Intensive Module â€¢ 4 hours
                </p>
                <div class="progress-dots">
                    <span class="dot filled"></span>
                    <span class="dot filled"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                </div>
                <aside class="notes">
                    Welcome to 02UNIT. Today we explore how abstraction and encapsulation 
                    help us manage complexity in research software.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- HOOK 1: The Mars Climate Orbiter -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸš€ Why Do Types Matter?</h2>
                
                <div class="hook-box">
                    <p>
                        On 23 September 1999, NASA's Mars Climate Orbiter disintegrated 
                        in the Martian atmosphere. The cause: a function in the navigation 
                        software returned impulse in <strong>pound-seconds</strong>, 
                        but the calling function expected <strong>newton-seconds</strong>.
                    </p>
                    <p>
                        Mission cost: <strong>$327.6 million</strong>.
                    </p>
                    <p class="source">
                        â€” NASA Mars Climate Orbiter Mishap Investigation Board Report, 1999
                    </p>
                </div>
                
                <p class="fragment">
                    A more expressive type system would have prevented this error 
                    <span class="highlight-text">at compile time</span>, not 140 million km away.
                </p>
                
                <aside class="notes">
                    This is perhaps the most expensive type error in history. The root cause
                    was a mismatch between imperial and metric units in the software interface.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- LEARNING OBJECTIVES -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ¯ Learning Objectives</h2>
                
                <p>By the end of this session, you will be able to:</p>
                
                <ol>
                    <li class="fragment">
                        <strong>[Understand]</strong> Explain core OOP principles 
                        (SOLID) and their applications in research software
                    </li>
                    <li class="fragment">
                        <strong>[Apply]</strong> Implement Strategy, Observer and 
                        Factory patterns in simulation code
                    </li>
                    <li class="fragment">
                        <strong>[Analyse]</strong> Refactor procedural code into 
                        well-structured object-oriented design
                    </li>
                </ol>
                
                <aside class="notes">
                    These objectives are aligned with Bloom's taxonomy at the 
                    Understand and Apply levels.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- RECAP FROM WEEK 1 -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ“– Recap: 01UNIT</h2>
                
                <div class="two-columns">
                    <div>
                        <h4>Turing Machines</h4>
                        <ul style="font-size: 0.85em;">
                            <li>State transitions</li>
                            <li>Tape as memory abstraction</li>
                            <li>Universal computation</li>
                        </ul>
                    </div>
                    <div>
                        <h4>AST Interpreters</h4>
                        <ul style="font-size: 0.85em;">
                            <li>Tree structure for expressions</li>
                            <li>Visitor pattern (preview)</li>
                            <li>Recursive evaluation</li>
                        </ul>
                    </div>
                </div>
                
                <div class="fragment definition-box">
                    <h4>Connection to Today</h4>
                    <p>
                        <strong>State</strong> from Turing machines â†’ <strong>State pattern</strong><br>
                        <strong>AST hierarchies</strong> â†’ <strong>Design patterns</strong> for extensibility
                    </p>
                </div>
                
                <aside class="notes">
                    The concepts from 01UNIT directly inform today's material.
                    State machines become the State pattern, and AST structures
                    demonstrate the need for extensible designs.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- AGENDA -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ“‹ Agenda</h2>
                
                <table>
                    <tr>
                        <th>Time</th>
                        <th>Module</th>
                        <th>Content</th>
                    </tr>
                    <tr>
                        <td>0:00 - 0:45</td>
                        <td>Theory</td>
                        <td>Abstraction, Encapsulation, Contracts</td>
                    </tr>
                    <tr>
                        <td>0:45 - 1:30</td>
                        <td>Python</td>
                        <td>Protocols, Generics, Descriptors</td>
                    </tr>
                    <tr>
                        <td>1:30 - 1:45</td>
                        <td colspan="2" style="text-align: center;">â˜• Break</td>
                    </tr>
                    <tr>
                        <td>1:45 - 2:30</td>
                        <td>Patterns</td>
                        <td>Strategy, Observer, Factory</td>
                    </tr>
                    <tr>
                        <td>2:30 - 3:15</td>
                        <td>SOLID</td>
                        <td>Principles with Research Examples</td>
                    </tr>
                    <tr>
                        <td>3:15 - 4:00</td>
                        <td>Lab</td>
                        <td>Simulation Framework Implementation</td>
                    </tr>
                </table>
                
                <aside class="notes">
                    We have a packed session today. The lab at the end will tie 
                    everything together with a practical implementation.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- PART I: THEORETICAL FOUNDATIONS -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <section>
                    <h1>PART I</h1>
                    <h2 style="color: #58a6ff;">Theoretical Foundations</h2>
                    <p class="small-text">45 minutes</p>
                </section>
                
                <!-- HOOK 2: The Leaky Abstraction -->
                <section>
                    <h2>The Law of Leaky Abstractions</h2>
                    
                    <div class="hook-box">
                        <p>
                            <em>"All non-trivial abstractions, to some degree, are leaky."</em>
                        </p>
                        <p class="source">
                            â€” Joel Spolsky, 2002
                        </p>
                    </div>
                    
                    <div class="fragment">
                        <p><strong>Examples:</strong></p>
                        <ul style="font-size: 0.85em;">
                            <li>TCP/IP "guarantees" ordered delivery â€” until the network fails</li>
                            <li>SQL hides storage details â€” until you have 10 million rows</li>
                            <li>Python hides memory management â€” until you have a memory leak in a 24-hour loop</li>
                        </ul>
                    </div>
                    
                    <p class="fragment highlight-text">
                        Good abstractions don't eliminate complexity â€” they <em>manage</em> it.
                    </p>
                    
                    <aside class="notes">
                        This represents a fundamental insight. Abstractions are tools for managing 
                        complexity, not eliminating it. When they leak, we need to 
                        understand the underlying layer.
                    </aside>
                </section>
                
                <!-- WHAT IS ABSTRACTION -->
                <section>
                    <h2>What is Abstraction?</h2>
                    
                    <div class="definition-box">
                        <h4>Formal Definition</h4>
                        <p>
                            <strong>Abstraction</strong> is the process of identifying 
                            <em>essential characteristics</em> of a concept whilst ignoring 
                            details irrelevant to the current context.
                        </p>
                    </div>
                    
                    <div class="diagram-box fragment">
<pre>
                     REALITY                        ABSTRACTION
                          
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â€¢ Colour: red              â”‚         â”‚                     â”‚
â”‚  â€¢ Make: Toyota             â”‚         â”‚      VEHICLE        â”‚
â”‚  â€¢ Year: 2019               â”‚   â”€â”€â–¶   â”‚                     â”‚
â”‚  â€¢ Registration: B-123-ABC  â”‚         â”‚  â€¢ accelerate()     â”‚
â”‚  â€¢ Mileage: 45,231          â”‚         â”‚  â€¢ brake()          â”‚
â”‚  â€¢ Fuel: petrol             â”‚         â”‚  â€¢ steer()          â”‚
â”‚  â€¢ Interior: black leather  â”‚         â”‚                     â”‚
â”‚  â€¢ GPS: yes                 â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â€¢ Air conditioning: yes    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         What is ESSENTIAL for
          All details                   driving?
</pre>
                    </div>
                    
                    <aside class="notes">
                        Notice how the abstraction captures only what's needed for the 
                        task at hand. A different context might require different details.
                    </aside>
                </section>
                
                <!-- LEVELS OF ABSTRACTION -->
                <section>
                    <h2>Levels of Abstraction</h2>
                    
                    <div class="diagram-box">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ABSTRACTION PYRAMID                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚    Level 5: DOMAIN                    "Analyse the sales"       â”‚
â”‚              â”‚                                                   â”‚
â”‚    Level 4: APPLICATION               pandas.read_csv().plot()  â”‚
â”‚              â”‚                                                   â”‚
â”‚    Level 3: LANGUAGE                  for item in list: ...     â”‚
â”‚              â”‚                                                   â”‚
â”‚    Level 2: RUNTIME                   Python bytecode, GC       â”‚
â”‚              â”‚                                                   â”‚
â”‚    Level 1: SYSTEM                    syscalls, threads         â”‚
â”‚              â”‚                                                   â”‚
â”‚    Level 0: HARDWARE                  CPU, RAM, disk            â”‚
â”‚                                                                  â”‚
â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚    Each level HIDES the details of the level below.             â”‚
â”‚    When abstraction "leaks", we must descend a level.           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                    </div>
                    
                    <aside class="notes">
                        As researchers, we typically work at levels 4-5, but debugging 
                        often requires understanding levels 2-3.
                    </aside>
                </section>
                
                <!-- ENCAPSULATION -->
                <section>
                    <h2>Encapsulation: Hiding Implementation</h2>
                    
                    <div class="two-columns">
                        <div>
                            <h4 style="color: #f85149;">Without Encapsulation</h4>
                            <pre><code class="language-python" style="font-size: 0.7em;">
# Client knows internal structure
account.balance = account.balance + 100
account.transactions.append(
    ("deposit", 100, datetime.now())
)
account.last_modified = datetime.now()

# What if we change the structure?
# All clients break!
                            </code></pre>
                        </div>
                        <div>
                            <h4 style="color: #3fb950;">With Encapsulation</h4>
                            <pre><code class="language-python" style="font-size: 0.7em;">
# Client uses the interface
account.deposit(100)

# Implementation could be:
# - in-memory dict
# - PostgreSQL
# - blockchain
# - external service
# 
# The client doesn't need to know!
                            </code></pre>
                        </div>
                    </div>
                    
                    <div class="fragment definition-box">
                        <h4>The Principle</h4>
                        <p>
                            <strong>Encapsulation</strong> separates <em>WHAT</em> a module does (interface) 
                            from <em>HOW</em> it does it (implementation).
                        </p>
                    </div>
                    
                    <aside class="notes">
                        Encapsulation is the first line of defence against change propagation.
                        When implementation changes, clients remain unaffected.
                    </aside>
                </section>
                
                <!-- FUNCTIONS AS CONTRACTS -->
                <section>
                    <h2>Functions as Mathematical Contracts</h2>
                    
                    <div class="definition-box">
                        <h4>Design by Contract (Bertrand Meyer, 1986)</h4>
                        <p>A function is a <strong>contract</strong> between caller and implementation:</p>
                        <ul>
                            <li><strong>Preconditions:</strong> What must be true BEFORE the call</li>
                            <li><strong>Postconditions:</strong> What the function guarantees AFTER execution</li>
                            <li><strong>Invariants:</strong> What remains unchanged</li>
                        </ul>
                    </div>
                    
                    <pre class="fragment"><code class="language-python" data-trim>
def binary_search(items: list[T], target: T) -> int | None:
    """
    Search for target in items using binary search.
    
    Preconditions:
        - items is sorted in ascending order
        - all elements in items are comparable with target
        
    Postconditions:
        - If returns i: items[i] == target
        - If returns None: target does not exist in items
        
    Invariant:
        - items is not modified
        
    Complexity: O(log n)
    """
                    </code></pre>
                    
                    <aside class="notes">
                        Design by Contract makes implicit assumptions explicit.
                        This is particularly valuable in research code where assumptions
                        about data are often unstated.
                    </aside>
                </section>
                
                <!-- MATHEMATICAL FOUNDATION: TYPES -->
                <section>
                    <h2>Mathematical Foundation: Types as Sets</h2>
                    
                    <p>In type theory, a <strong>type</strong> can be viewed as a <strong>set</strong>:</p>
                    
                    <div class="math-display">
                        <p>
                            <code>int</code> â‰ˆ â„¤ (the set of integers)<br>
                            <code>float</code> â‰ˆ â„ (approximated, with finite precision)<br>
                            <code>bool</code> â‰ˆ {True, False}<br>
                            <code>str</code> â‰ˆ Î£* (all strings over alphabet Î£)
                        </p>
                    </div>
                    
                    <div class="fragment">
                        <p>A <strong>typed function</strong> <code>f: A â†’ B</code> is a mapping between sets:</p>
                        <div class="math-display">
                            <p>
                                âˆ€x âˆˆ A: f(x) âˆˆ B
                            </p>
                        </div>
                    </div>
                    
                    <div class="fragment theorem-box">
                        <h4>Curry-Howard Isomorphism</h4>
                        <p>
                            <strong>Types = Propositions</strong>, <strong>Programs = Proofs</strong><br>
                            A program that compiles is a proof that its type is "inhabited".
                        </p>
                    </div>
                    
                    <aside class="notes">
                        This correspondence between logic and programming is profound.
                        When you write a function with a particular signature, you're 
                        proving that the output type can be constructed from the input type.
                    </aside>
                </section>
                
                <!-- POLYMORPHISM -->
                <section>
                    <h2>Polymorphism: Three Forms</h2>
                    
                    <table>
                        <tr>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                        <tr>
                            <td><strong>Ad-hoc</strong><br>(Overloading)</td>
                            <td>Same name, different behaviour per type</td>
                            <td><code>1 + 2</code> vs <code>"a" + "b"</code></td>
                        </tr>
                        <tr>
                            <td><strong>Parametric</strong><br>(Generics)</td>
                            <td>Identical code for any type</td>
                            <td><code>list[T]</code>, <code>Optional[T]</code></td>
                        </tr>
                        <tr>
                            <td><strong>Subtype</strong><br>(Inheritance)</td>
                            <td>Subtype can replace supertype</td>
                            <td><code>Cat</code> extends <code>Animal</code></td>
                        </tr>
                    </table>
                    
                    <div class="diagram-box fragment" style="font-size: 0.6em;">
<pre>
Ad-hoc (compile-time dispatch)       Subtype (runtime dispatch)

def add(a: int, b: int) â†’ int        class Animal:
def add(a: str, b: str) â†’ str            def speak(self): ...
                                     
Compiler chooses version             class Dog(Animal):
based on argument types                  def speak(self): print("Woof")
                                     
                                     # At runtime the correct method
Parametric (type erasure)            # is chosen based on REAL object type

def first[T](items: list[T]) â†’ T

Same code for any T
</pre>
                    </div>
                    
                    <aside class="notes">
                        Python primarily uses duck typing, which is a form of structural
                        subtyping. Protocols formalize this for static analysis.
                    </aside>
                </section>
                
                <!-- LISKOV SUBSTITUTION -->
                <section>
                    <h2>Liskov Substitution Principle</h2>
                    
                    <div class="hook-box">
                        <p>
                            <em>"If S is a subtype of T, then objects of type T may be replaced 
                            with objects of type S without altering any of the desirable 
                            properties of the program."</em>
                        </p>
                        <p class="source">
                            â€” Barbara Liskov, Turing Award 2008
                        </p>
                    </div>
                    
                    <div class="fragment warning-box">
                        <h4>Classic Violation Example</h4>
                        <pre><code class="language-python" style="font-size: 0.75em;">
class Rectangle:
    def set_width(self, w): self.width = w
    def set_height(self, h): self.height = h
    def area(self): return self.width * self.height

class Square(Rectangle):  # Is a square a rectangle? Mathematically, yes!
    def set_width(self, w): 
        self.width = self.height = w  # Maintains invariant
    def set_height(self, h): 
        self.width = self.height = h

# PROBLEM:
r = get_rectangle()  # Could be Square!
r.set_width(5)
r.set_height(10)
assert r.area() == 50  # FAILS if Square! Area = 100
                        </code></pre>
                    </div>
                    
                    <aside class="notes">
                        This is the famous Square-Rectangle problem. Mathematical 
                        "is-a" relationships don't always translate to behavioural 
                        substitutability.
                    </aside>
                </section>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- PART II: PYTHON -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <section>
                    <h1>PART II</h1>
                    <h2 style="color: #3572A5;">ğŸ Python</h2>
                    <p>Protocols, Generics, Type Hints</p>
                    <p class="small-text">45 minutes</p>
                </section>
                
                <!-- PROTOCOLS -->
                <section>
                    <h2>Protocols: Structural Subtyping</h2>
                    
                    <p>Python is <em>duck-typed</em>: "If it walks like a duck..."</p>
                    <p><code>Protocol</code> formalises this concept for type checkers.</p>
                    
                    <pre><code class="language-python" data-trim data-line-numbers="1-20">
from typing import Protocol, runtime_checkable

@runtime_checkable
class Comparable(Protocol):
    """Any object that can be compared with < and ==."""
    
    def __lt__(self, other: 'Comparable') -> bool: ...
    def __eq__(self, other: object) -> bool: ...

# Does NOT need to inherit from Comparable!
class Temperature:
    def __init__(self, celsius: float):
        self.celsius = celsius
    
    def __lt__(self, other: 'Temperature') -> bool:
        return self.celsius < other.celsius
    
    def __eq__(self, other: object) -> bool:
        if isinstance(other, Temperature):
            return self.celsius == other.celsius
        return NotImplemented

# Type checker understands Temperature is Comparable
def find_min(items: list[Comparable]) -> Comparable:
    return min(items, key=lambda x: x)
                    </code></pre>
                    
                    <aside class="notes">
                        Protocols enable structural subtyping in Python's type system.
                        The class doesn't need to explicitly inherit from the Protocol.
                    </aside>
                </section>
                
                <!-- GENERICS -->
                <section>
                    <h2>Generics: Parameterised Types</h2>
                    
                    <pre><code class="language-python" data-trim data-line-numbers>
from typing import TypeVar, Generic, Callable

T = TypeVar('T')  # Unconstrained generic type
K = TypeVar('K')  # Another generic type
V = TypeVar('V')

class Result(Generic[T]):
    """
    Container for result or error.
    Similar to Rust's Result or Haskell's Either.
    """
    def __init__(self, value: T | None, error: str | None = None):
        self._value = value
        self._error = error
    
    @classmethod
    def ok(cls, value: T) -> 'Result[T]':
        return cls(value, None)
    
    @classmethod  
    def err(cls, message: str) -> 'Result[T]':
        return cls(None, message)
    
    def unwrap(self) -> T:
        if self._error:
            raise ValueError(self._error)
        return self._value  # type: ignore
    
    def map(self, f: Callable[[T], K]) -> 'Result[K]':
        if self._error:
            return Result.err(self._error)
        return Result.ok(f(self._value))
                    </code></pre>
                    
                    <aside class="notes">
                        Generics allow us to write type-safe code that works with any type.
                        The Result type is particularly useful for error handling without exceptions.
                    </aside>
                </section>
                
                <!-- DATACLASSES -->
                <section>
                    <h2>Dataclasses: Concise Data Types</h2>
                    
                    <pre><code class="language-python" data-trim data-line-numbers>
from dataclasses import dataclass, field

@dataclass(frozen=True)  # Immutable!
class SIRState:
    """State of an SIR epidemic model."""
    susceptible: float
    infected: float
    recovered: float
    time: float = 0.0
    
    def __post_init__(self) -> None:
        """Validate state invariants."""
        total = self.susceptible + self.infected + self.recovered
        if abs(total - 1.0) > 1e-9:
            raise ValueError(f"S+I+R must equal 1, got {total}")

@dataclass
class SimulationConfig:
    """Configuration with mutable defaults."""
    dt: float = 0.01
    max_steps: int = 1000
    observers: list[Observer] = field(default_factory=list)
                    </code></pre>
                    
                    <div class="fragment definition-box">
                        <h4>Benefits of frozen=True</h4>
                        <ul>
                            <li>Immutable instances (safer for concurrent code)</li>
                            <li>Hashable (can be used in sets and as dict keys)</li>
                            <li>Easier to reason about (no hidden state changes)</li>
                        </ul>
                    </div>
                    
                    <aside class="notes">
                        Immutable data structures form a foundation of functional programming
                        and make debugging much easier.
                    </aside>
                </section>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- PART III: DESIGN PATTERNS -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <section>
                    <h1>PART III</h1>
                    <h2 style="color: #58a6ff;">Design Patterns</h2>
                    <p>Strategy, Observer, Factory</p>
                    <p class="small-text">45 minutes</p>
                </section>
                
                <!-- STRATEGY PATTERN -->
                <section>
                    <h2>Strategy Pattern</h2>
                    
                    <div class="definition-box">
                        <h4>Intent</h4>
                        <p>
                            Define a family of algorithms, encapsulate each one, and make them 
                            interchangeable. Strategy lets the algorithm vary independently from 
                            clients that use it.
                        </p>
                    </div>
                    
                    <pre><code class="language-python" data-trim data-line-numbers>
class IntegrationStrategy(Protocol):
    """Protocol for numerical integration methods."""
    def integrate(self, f: Callable, a: float, b: float, n: int) -> float: ...

class SimpsonRule:
    def integrate(self, f: Callable, a: float, b: float, n: int) -> float:
        h = (b - a) / n
        # Simpson's 1/3 rule implementation
        return h / 3 * sum(...)

class NumericalIntegrator:
    def __init__(self, strategy: IntegrationStrategy):
        self._strategy = strategy
    
    def integrate(self, f: Callable, a: float, b: float, n: int = 100) -> float:
        return self._strategy.integrate(f, a, b, n)

# Usage: swap strategies at runtime!
integrator = NumericalIntegrator(SimpsonRule())
result1 = integrator.integrate(lambda x: x**2, 0, 1)

integrator._strategy = TrapezoidRule()
result2 = integrator.integrate(lambda x: x**2, 0, 1)
                    </code></pre>
                    
                    <aside class="notes">
                        The Strategy pattern is perfect for algorithm selection in simulations.
                        Different integration methods, optimisers, or solvers can be swapped.
                    </aside>
                </section>
                
                <!-- OBSERVER PATTERN -->
                <section>
                    <h2>Observer Pattern</h2>
                    
                    <div class="definition-box">
                        <h4>Intent</h4>
                        <p>
                            Define a one-to-many dependency between objects so that when one 
                            object changes state, all its dependents are notified and updated 
                            automatically.
                        </p>
                    </div>
                    
                    <pre><code class="language-python" data-trim data-line-numbers>
from typing import TypeVar, Generic, Callable

T = TypeVar('T')

class Observable(Generic[T]):
    """Subject that notifies observers of state changes."""
    
    def __init__(self) -> None:
        self._observers: list[Callable[[T], None]] = []
    
    def subscribe(self, callback: Callable[[T], None]) -> None:
        self._observers.append(callback)
    
    def unsubscribe(self, callback: Callable[[T], None]) -> None:
        self._observers.remove(callback)
    
    def notify(self, value: T) -> None:
        for observer in self._observers:
            observer(value)

# Usage in simulation
sim_events = Observable[SIRState]()
sim_events.subscribe(console_logger.update)
sim_events.subscribe(plot_updater.update)
sim_events.subscribe(metrics_collector.update)

# During simulation step
sim_events.notify(new_state)  # All observers notified
                    </code></pre>
                    
                    <aside class="notes">
                        Observer is ideal for decoupling simulation logic from visualisation
                        and logging. The simulation doesn't need to know who's watching.
                    </aside>
                </section>
                
                <!-- FACTORY PATTERN -->
                <section>
                    <h2>Factory Pattern</h2>
                    
                    <div class="definition-box">
                        <h4>Intent</h4>
                        <p>
                            Define an interface for creating an object, but let subclasses 
                            decide which class to instantiate. Factory Method lets a class 
                            defer instantiation to subclasses.
                        </p>
                    </div>
                    
                    <pre><code class="language-python" data-trim data-line-numbers>
class AgentFactory(Protocol):
    """Factory for creating simulation agents."""
    def create(self, agent_id: str) -> Agent: ...

class CooperativeAgentFactory:
    def create(self, agent_id: str) -> Agent:
        return CooperativeAgent(agent_id, strategy="tit-for-tat")

class CompetitiveAgentFactory:
    def create(self, agent_id: str) -> Agent:
        return CompetitiveAgent(agent_id, aggression=0.8)

class MarketSimulation:
    def __init__(self, agent_factory: AgentFactory, n_agents: int):
        self.agents = [
            agent_factory.create(f"agent_{i}")
            for i in range(n_agents)
        ]

# Different simulations with different agent types
coop_sim = MarketSimulation(CooperativeAgentFactory(), 100)
comp_sim = MarketSimulation(CompetitiveAgentFactory(), 100)
                    </code></pre>
                    
                    <aside class="notes">
                        Factory is useful when the exact type of object to create depends
                        on configuration or runtime conditions.
                    </aside>
                </section>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- PART IV: SOLID PRINCIPLES -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <section>
                    <h1>PART IV</h1>
                    <h2 style="color: #58a6ff;">SOLID Principles</h2>
                    <p>Guidelines for Maintainable Code</p>
                    <p class="small-text">45 minutes</p>
                </section>
                
                <!-- SOLID OVERVIEW -->
                <section>
                    <h2>SOLID at a Glance</h2>
                    
                    <table>
                        <tr>
                            <th>Letter</th>
                            <th>Principle</th>
                            <th>Research Example</th>
                        </tr>
                        <tr>
                            <td><strong style="color: #3fb950;">S</strong></td>
                            <td>Single Responsibility</td>
                            <td>DataLoader vs DataValidator</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #f85149;">O</strong></td>
                            <td>Open/Closed</td>
                            <td>Add new Strategy, don't modify Context</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #a371f7;">L</strong></td>
                            <td>Liskov Substitution</td>
                            <td>Any Simulable works in Runner</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #d29922;">I</strong></td>
                            <td>Interface Segregation</td>
                            <td>Readable, Writable vs monolithic File</td>
                        </tr>
                        <tr>
                            <td><strong style="color: #58a6ff;">D</strong></td>
                            <td>Dependency Inversion</td>
                            <td>Inject Database protocol, not PostgresDB</td>
                        </tr>
                    </table>
                    
                    <aside class="notes">
                        SOLID principles guide us toward code that's easier to maintain,
                        test, and extend. They're especially valuable in research code
                        that evolves over time.
                    </aside>
                </section>
                
                <!-- DEPENDENCY INVERSION -->
                <section>
                    <h2>Dependency Inversion in Practice</h2>
                    
                    <div class="two-columns">
                        <div>
                            <h4 style="color: #f85149;">Violates DIP</h4>
                            <pre><code class="language-python" style="font-size: 0.7em;">
class DataAnalyser:
    def __init__(self):
        # Hard dependency!
        self.db = PostgresDB()
        self.logger = FileLogger()
    
    def analyse(self, query):
        data = self.db.query(query)
        self.logger.log(f"Analysed {len(data)}")
        return process(data)
    
# Cannot test without real DB!
# Cannot change storage without modifying class!
                            </code></pre>
                        </div>
                        <div>
                            <h4 style="color: #3fb950;">Follows DIP</h4>
                            <pre><code class="language-python" style="font-size: 0.7em;">
class DataAnalyser:
    def __init__(
        self,
        db: Database,      # Protocol
        logger: Logger     # Protocol
    ):
        self.db = db
        self.logger = logger
    
    def analyse(self, query):
        data = self.db.query(query)
        self.logger.log(f"Analysed {len(data)}")
        return process(data)

# Easy to test with mocks!
# Easy to swap implementations!
                            </code></pre>
                        </div>
                    </div>
                    
                    <div class="fragment theorem-box">
                        <h4>The Principle</h4>
                        <p>
                            High-level modules should not depend on low-level modules.<br>
                            Both should depend on <strong>abstractions</strong>.
                        </p>
                    </div>
                    
                    <aside class="notes">
                        Dependency Inversion is essential for testability. By depending on
                        abstractions, we can inject mock implementations during testing.
                    </aside>
                </section>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- QUIZ -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ§  Quick Quiz</h2>
                
                <p><strong>Question 1:</strong> What's the difference between Protocol and ABC?</p>
                
                <div class="fragment">
                    <p><strong>Answer:</strong></p>
                    <ul>
                        <li><strong>Protocol:</strong> Structural subtyping (duck typing with hints)</li>
                        <li><strong>ABC:</strong> Nominal subtyping (requires explicit inheritance)</li>
                    </ul>
                </div>
                
                <p class="fragment"><strong>Question 2:</strong> When would you use Strategy vs Factory?</p>
                
                <div class="fragment">
                    <p><strong>Answer:</strong></p>
                    <ul>
                        <li><strong>Strategy:</strong> Different algorithms for the same operation</li>
                        <li><strong>Factory:</strong> Creating different types of objects</li>
                    </ul>
                </div>
                
                <aside class="notes">
                    These questions test understanding of the key distinctions covered today.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- LAB -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ”¬ Laboratory: Simulation Framework</h2>
                
                <div class="diagram-box">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SIMULATION FRAMEWORK                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Protocol/Interface:              Concrete Implementations:            â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚    Simulable[T]     â”‚         â”‚   ParticleSystem    â”‚              â”‚
â”‚   â”‚                     â”‚         â”‚   (N-body physics)  â”‚              â”‚
â”‚   â”‚  + setup() â†’ None   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚              â”‚
â”‚   â”‚  + step(dt) â†’ None  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚   â”‚  + state() â†’ T      â”‚                                              â”‚
â”‚   â”‚  + is_done() â†’ bool â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    EpidemicModel    â”‚              â”‚
â”‚             â–²                     â”‚   (SIR dynamics)    â”‚              â”‚
â”‚             â”‚                     â”‚                     â”‚              â”‚
â”‚             â”‚              â—„â”€â”€â”€â”€â”€â”€â”‚                     â”‚              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚   â”‚   SimulationRunner  â”‚                                              â”‚
â”‚   â”‚                     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ Orchestrates any    â”‚         â”‚   MarketSimulator   â”‚              â”‚
â”‚   â”‚ Simulable, regardlessâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”‚   (agent-based)     â”‚              â”‚
â”‚   â”‚ of implementation   â”‚         â”‚                     â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                         â”‚
â”‚   Deliverables:                                                        â”‚
â”‚   âœ“ Simulable Protocol with generics                                   â”‚
â”‚   âœ“ 2+ concrete implementations                                        â”‚
â”‚   âœ“ Generic runner that works with any Simulable                       â”‚
â”‚   âœ“ Real-time state visualisation                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
                
                <aside class="notes">
                    The lab brings together all concepts from today. Students will
                    implement a flexible simulation framework using patterns and protocols.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- HOMEWORK -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ“ Homework for 03UNIT</h2>
                
                <ol>
                    <li class="fragment">
                        <strong>Units Library:</strong> Implement a type system
                        that prevents errors like the Mars Climate Orbiter:
                        <pre><code class="language-python">
metres = Metres(100)
feet = Feet(328)
# metres + feet  # Type error!
total = metres + feet.to_metres()  # OK
                        </code></pre>
                    </li>
                    
                    <li class="fragment">
                        <strong>Result Monad:</strong> Extend the <code>Result[T]</code>
                        class with <code>and_then</code>, <code>or_else</code>, <code>unwrap_or</code> methods.
                    </li>
                    
                    <li class="fragment">
                        <strong>Type-Safe Builder:</strong> Implement a Builder pattern
                        where the compiler verifies that all required fields are set.
                    </li>
                </ol>
                
                <aside class="notes">
                    These exercises reinforce today's concepts with practical applications.
                    The Units Library directly addresses the Mars Orbiter scenario.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- NEW SLIDE 35: DEPENDENCY INJECTION DEEP DIVE -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ’‰ Dependency Injection in Depth</h2>
                
                <p>Dependencies flow <em>inward</em>, not outward:</p>
                
                <div class="diagram-box">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              HIGH-LEVEL POLICY (SimulationRunner)           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚                    ABSTRACTION                     â”‚    â”‚
â”‚    â”‚              Simulable Protocol                    â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â†‘                    â†‘                    â†‘         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”     â”‚
â”‚    â”‚   SIR   â”‚         â”‚  SEIR   â”‚         â”‚  Custom â”‚     â”‚
â”‚    â”‚  Model  â”‚         â”‚  Model  â”‚         â”‚  Model  â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚              LOW-LEVEL DETAILS (Concrete Models)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
                
                <div class="fragment definition-box">
                    <h4>Inversion of Control (IoC)</h4>
                    <p>
                        The framework calls your code, not vice versa.
                        Dependencies are <em>injected</em>, not instantiated.
                    </p>
                </div>
                
                <aside class="notes">
                    DIP enables testing in isolation and supports plugin architectures.
                    The simulation runner never imports concrete model classes.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- NEW SLIDE 36: TESTING WITH DESIGN PATTERNS -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ§ª Testing with Design Patterns</h2>
                
                <p>Patterns enable <strong>isolated</strong> and <strong>repeatable</strong> tests:</p>
                
                <pre><code class="language-python" data-trim>
class MockSimulation:
    """Test double for any Simulable."""
    def __init__(self, states: list[dict]):
        self._states = iter(states)
        self._current = next(self._states)
    
    def state(self) -> dict:
        return self._current
    
    def step(self, dt: float) -> None:
        try:
            self._current = next(self._states)
        except StopIteration:
            pass
    
    def is_done(self) -> bool:
        return False

def test_runner_collects_history():
    mock = MockSimulation([{"S": 99}, {"S": 98}])
    runner = SimulationRunner(mock)
    history = runner.run(steps=2)
    assert len(history) == 2
                </code></pre>
                
                <p class="small-text fragment">
                    âœ“ No real computation needed &nbsp;
                    âœ“ Deterministic results &nbsp;
                    âœ“ Fast execution
                </p>
                
                <aside class="notes">
                    Mock objects satisfy the protocol without expensive computation.
                    This enables testing the runner independently of any real model.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- NEW SLIDE 37: REAL-WORLD CASE STUDY -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ“š Case Study: NumPy's Array Protocol</h2>
                
                <p>NumPy defines the <code>__array__</code> protocol:</p>
                
                <pre><code class="language-python" data-trim>
class MyDataContainer:
    """Custom container compatible with NumPy."""
    def __init__(self, data: list[float]):
        self._data = data
    
    def __array__(self, dtype=None):
        """Protocol method: convert to ndarray."""
        import numpy as np
        return np.array(self._data, dtype=dtype)

# Works with any NumPy function!
container = MyDataContainer([1.0, 2.0, 3.0])
result = np.mean(container)  # NumPy calls __array__
                </code></pre>
                
                <div class="fragment theorem-box">
                    <h4>Key Insight</h4>
                    <p>
                        By implementing the protocol, your class integrates with
                        the full NumPy library suiteâ€”hundreds of functionsâ€”without
                        NumPy knowing anything about your class.
                    </p>
                </div>
                
                <aside class="notes">
                    This is structural subtyping in action in production libraries.
                    Pandas, xarray, and many other libraries use this same protocol.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- NEW SLIDE 38: ANTI-PATTERNS TO AVOID -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>âš ï¸ Anti-Patterns to Recognise</h2>
                
                <table>
                    <thead>
                        <tr>
                            <th>Anti-Pattern</th>
                            <th>Symptom</th>
                            <th>Remedy</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="fragment">
                            <td><strong>God Class</strong></td>
                            <td>Class &gt;500 lines, does "everything"</td>
                            <td>Extract responsibilities into focused classes</td>
                        </tr>
                        <tr class="fragment">
                            <td><strong>Shotgun Surgery</strong></td>
                            <td>One change requires edits in 10 files</td>
                            <td>Consolidate related logic</td>
                        </tr>
                        <tr class="fragment">
                            <td><strong>Feature Envy</strong></td>
                            <td>Method uses other class's data extensively</td>
                            <td>Move method to the data's class</td>
                        </tr>
                        <tr class="fragment">
                            <td><strong>Primitive Obsession</strong></td>
                            <td>Passing raw floats instead of typed values</td>
                            <td>Create domain types (Meters, Seconds)</td>
                        </tr>
                    </tbody>
                </table>
                
                <aside class="notes">
                    Anti-patterns are recognisable bad practices. Learning to spot them
                    is as important as learning good patterns.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- NEW SLIDE 39: REFACTORING TOWARDS PATTERNS -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ”„ Refactoring Towards Patterns</h2>
                
                <p>Patterns emerge from code; they are not imposed upon it:</p>
                
                <div class="code-evolution">
                    <div>
                        <p class="small-text">Before</p>
                        <pre><code class="language-python" data-trim style="font-size: 0.7em;">
if method == "euler":
    # 20 lines of Euler
elif method == "rk4":
    # 30 lines of RK4
elif method == "rk45":
    # 50 lines of RK45
                        </code></pre>
                    </div>
                    <span class="arrow">â†’</span>
                    <div>
                        <p class="small-text">After (Strategy)</p>
                        <pre><code class="language-python" data-trim style="font-size: 0.7em;">
class Integrator(Protocol):
    def step(self, f, y, t, dt): ...

solver.set_integrator(RK4())
                        </code></pre>
                    </div>
                </div>
                
                <ol class="fragment" style="font-size: 0.85em;">
                    <li>Identify code that varies independently</li>
                    <li>Extract interface capturing the variation</li>
                    <li>Create concrete implementations</li>
                    <li>Inject dependency at construction</li>
                </ol>
                
                <aside class="notes">
                    Refactoring is iterative. Extract patterns only when the need
                    becomes clearâ€”when you have 2-3 concrete cases.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- NEW SLIDE 40: BEST PRACTICES CHECKLIST -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>âœ… Design Checklist</h2>
                
                <p>Before committing code, verify:</p>
                
                <div class="two-columns" style="font-size: 0.85em;">
                    <div>
                        <p><strong>Interface Design</strong></p>
                        <ul>
                            <li class="fragment">â˜ Single responsibility per class?</li>
                            <li class="fragment">â˜ Protocols over ABCs where possible?</li>
                            <li class="fragment">â˜ No fat interfaces?</li>
                            <li class="fragment">â˜ Dependencies on abstractions?</li>
                        </ul>
                    </div>
                    <div>
                        <p><strong>Implementation</strong></p>
                        <ul>
                            <li class="fragment">â˜ Type hints complete?</li>
                            <li class="fragment">â˜ Invariants documented?</li>
                            <li class="fragment">â˜ Composition over inheritance?</li>
                            <li class="fragment">â˜ Testable in isolation?</li>
                        </ul>
                    </div>
                </div>
                
                <div class="fragment definition-box" style="margin-top: 20px;">
                    <h4>The Litmus Test</h4>
                    <p>
                        Can you describe what your class does in one sentence
                        without using "and"?
                    </p>
                </div>
                
                <aside class="notes">
                    This checklist helps catch design issues during code review.
                    The single-sentence test is a quick SRP check.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- SUMMARY -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section>
                <h2>ğŸ“Œ Key Takeaways</h2>
                
                <ol>
                    <li class="fragment">
                        <strong>Abstraction</strong> manages complexity by hiding irrelevant details
                    </li>
                    <li class="fragment">
                        <strong>Encapsulation</strong> separates interface from implementation
                    </li>
                    <li class="fragment">
                        <strong>Protocols</strong> enable structural subtyping in Python
                    </li>
                    <li class="fragment">
                        <strong>Design patterns</strong> (Strategy, Observer, Factory) solve recurring problems
                    </li>
                    <li class="fragment">
                        <strong>SOLID principles</strong> guide maintainable design
                    </li>
                </ol>
                
                <div class="fragment definition-box">
                    <h4>Next Week Preview</h4>
                    <p>
                        <strong>03UNIT: Algorithmic Complexity</strong><br>
                        Big-O notation, benchmarking, empirical complexity analysis
                    </p>
                </div>
                
                <aside class="notes">
                    Summarise the key points and preview next week's content.
                </aside>
            </section>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- END SLIDE -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <section data-background-gradient="linear-gradient(135deg, #0d1117 0%, #161b22 100%)">
                <h1>Questions?</h1>
                <p style="color: #8b949e;">
                    Next week: <strong>Algorithmic Complexity</strong>
                </p>
                <hr style="border-color: #30363d; margin: 30px 0;">
                <p style="font-size: 0.7em; color: #8b949e;">
                    ğŸ“§ antonio.clim@csie.ase.ro<br>
                    ğŸ”— github.com/ase-csie/computational-thinking
                </p>
                
                <aside class="notes">
                    Open floor for questions. Remind students about office hours
                    and available resources.
                </aside>
            </section>
            
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/highlight/highlight.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/math/math.js"></script>
    
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: 'c/t',
            transition: 'slide',
            plugins: [ RevealHighlight, RevealNotes, RevealMath.KaTeX ]
        });
    </script>
</body>
</html>
