<?xml version="1.0" encoding="UTF-8"?>
<!--
═══════════════════════════════════════════════════════════════════════════════
COMPUTATIONAL THINKING FOR RESEARCHERS
Week 6: Visualisation for Research
Diagram: Grammar of Graphics Components
═══════════════════════════════════════════════════════════════════════════════

This diagram illustrates the seven components of Leland Wilkinson's Grammar of
Graphics framework, showing how they layer together to create visualisations.

© 2025 Antonio Clim. All rights reserved.
═══════════════════════════════════════════════════════════════════════════════
-->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600" width="900" height="600">
  <defs>
    <!-- Gradient backgrounds -->
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    
    <!-- Drop shadow filter -->
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.4"/>
    </filter>
    
    <!-- Glow effect for connections -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <!-- Arrow marker -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#56CCF2"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="600" fill="url(#bgGradient)"/>
  
  <!-- Title -->
  <text x="450" y="45" text-anchor="middle" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="24" font-weight="bold">
    Grammar of Graphics: Seven Components
  </text>
  <text x="450" y="70" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="14">
    Based on Leland Wilkinson's framework (1999)
  </text>
  
  <!-- Layer 1: DATA (Foundation) -->
  <g transform="translate(80, 110)">
    <rect x="0" y="0" width="160" height="70" rx="8" ry="8" fill="#0072B2" filter="url(#dropShadow)"/>
    <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      1. DATA
    </text>
    <text x="80" y="45" text-anchor="middle" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      The dataset to visualise
    </text>
    <text x="80" y="60" text-anchor="middle" fill="#AAD4E8" font-family="monospace" font-size="10">
      pd.DataFrame()
    </text>
  </g>
  
  <!-- Layer 2: AESTHETICS -->
  <g transform="translate(260, 110)">
    <rect x="0" y="0" width="160" height="70" rx="8" ry="8" fill="#E69F00" filter="url(#dropShadow)"/>
    <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      2. AESTHETICS
    </text>
    <text x="80" y="45" text-anchor="middle" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      Data → visual properties
    </text>
    <text x="80" y="60" text-anchor="middle" fill="#FDE5B4" font-family="monospace" font-size="10">
      x, y, colour, size
    </text>
  </g>
  
  <!-- Layer 3: GEOMETRY -->
  <g transform="translate(440, 110)">
    <rect x="0" y="0" width="160" height="70" rx="8" ry="8" fill="#009E73" filter="url(#dropShadow)"/>
    <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      3. GEOMETRY
    </text>
    <text x="80" y="45" text-anchor="middle" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      Visual marks/shapes
    </text>
    <text x="80" y="60" text-anchor="middle" fill="#B4E8D4" font-family="monospace" font-size="10">
      point, line, bar, area
    </text>
  </g>
  
  <!-- Layer 4: FACETS -->
  <g transform="translate(620, 110)">
    <rect x="0" y="0" width="160" height="70" rx="8" ry="8" fill="#CC79A7" filter="url(#dropShadow)"/>
    <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      4. FACETS
    </text>
    <text x="80" y="45" text-anchor="middle" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      Split into subplots
    </text>
    <text x="80" y="60" text-anchor="middle" fill="#EACFE1" font-family="monospace" font-size="10">
      row, column, wrap
    </text>
  </g>
  
  <!-- Layer 5: STATISTICS -->
  <g transform="translate(170, 210)">
    <rect x="0" y="0" width="160" height="70" rx="8" ry="8" fill="#56B4E9" filter="url(#dropShadow)"/>
    <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      5. STATISTICS
    </text>
    <text x="80" y="45" text-anchor="middle" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      Data transformations
    </text>
    <text x="80" y="60" text-anchor="middle" fill="#C5E5F7" font-family="monospace" font-size="10">
      bin, smooth, count
    </text>
  </g>
  
  <!-- Layer 6: COORDINATES -->
  <g transform="translate(350, 210)">
    <rect x="0" y="0" width="160" height="70" rx="8" ry="8" fill="#D55E00" filter="url(#dropShadow)"/>
    <text x="80" y="25" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      6. COORDINATES
    </text>
    <text x="80" y="45" text-anchor="middle" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      Coordinate system
    </text>
    <text x="80" y="60" text-anchor="middle" fill="#F5C5A7" font-family="monospace" font-size="10">
      cartesian, polar, map
    </text>
  </g>
  
  <!-- Layer 7: THEME -->
  <g transform="translate(530, 210)">
    <rect x="0" y="0" width="160" height="70" rx="8" ry="8" fill="#F0E442" filter="url(#dropShadow)"/>
    <text x="80" y="25" text-anchor="middle" fill="#333" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      7. THEME
    </text>
    <text x="80" y="45" text-anchor="middle" fill="#444" font-family="Arial, sans-serif" font-size="11">
      Non-data styling
    </text>
    <text x="80" y="60" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">
      fonts, colours, grids
    </text>
  </g>
  
  <!-- Connection arrows from layers to output -->
  <g filter="url(#glow)">
    <!-- Arrows from top row -->
    <path d="M160,180 Q160,310 340,380" stroke="#56CCF2" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
    <path d="M340,180 Q340,300 380,380" stroke="#56CCF2" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
    <path d="M520,180 Q520,310 440,380" stroke="#56CCF2" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
    <path d="M700,180 Q700,310 500,380" stroke="#56CCF2" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
    
    <!-- Arrows from middle row -->
    <path d="M250,280 Q250,340 370,380" stroke="#56CCF2" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
    <path d="M430,280 L430,375" stroke="#56CCF2" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
    <path d="M610,280 Q610,340 480,380" stroke="#56CCF2" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
  </g>
  
  <!-- Output: Final Visualisation -->
  <g transform="translate(280, 390)">
    <rect x="0" y="0" width="300" height="130" rx="10" ry="10" fill="#2D2D44" stroke="#56CCF2" stroke-width="3" filter="url(#dropShadow)"/>
    <text x="150" y="25" text-anchor="middle" fill="#56CCF2" font-family="Arial, sans-serif" font-size="14" font-weight="bold">
      FINAL VISUALISATION
    </text>
    
    <!-- Mini chart example inside -->
    <rect x="30" y="40" width="240" height="75" rx="4" ry="4" fill="#1a1a2e"/>
    
    <!-- Axes -->
    <line x1="50" y1="105" x2="250" y2="105" stroke="#666" stroke-width="1"/>
    <line x1="50" y1="50" x2="50" y2="105" stroke="#666" stroke-width="1"/>
    
    <!-- Bars -->
    <rect x="65" y="70" width="25" height="35" fill="#0072B2"/>
    <rect x="100" y="55" width="25" height="50" fill="#E69F00"/>
    <rect x="135" y="80" width="25" height="25" fill="#009E73"/>
    <rect x="170" y="60" width="25" height="45" fill="#CC79A7"/>
    <rect x="205" y="75" width="25" height="30" fill="#56B4E9"/>
    
    <!-- Trend line -->
    <path d="M77 70 L112 55 L147 80 L182 60 L217 75" stroke="#F0E442" stroke-width="2" fill="none"/>
  </g>
  
  <!-- Implementation examples -->
  <g transform="translate(50, 540)">
    <text x="0" y="0" fill="#888" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      Implementations:
    </text>
    <text x="110" y="0" fill="#56B4E9" font-family="monospace" font-size="11">ggplot2</text>
    <text x="180" y="0" fill="#E69F00" font-family="monospace" font-size="11">Plotly Express</text>
    <text x="290" y="0" fill="#009E73" font-family="monospace" font-size="11">Altair</text>
    <text x="350" y="0" fill="#CC79A7" font-family="monospace" font-size="11">Vega-Lite</text>
    <text x="430" y="0" fill="#56CCF2" font-family="monospace" font-size="11">Seaborn</text>
  </g>
  
  <!-- Key insight box -->
  <g transform="translate(600, 400)">
    <rect x="0" y="0" width="250" height="110" rx="6" ry="6" fill="#1a1a2e" stroke="#56CCF2" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="125" y="25" text-anchor="middle" fill="#56CCF2" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
      Key Insight
    </text>
    <text x="15" y="48" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      Each layer builds upon the previous,
    </text>
    <text x="15" y="65" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      creating a declarative specification
    </text>
    <text x="15" y="82" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      of the visualisation rather than
    </text>
    <text x="15" y="99" fill="#E8E8E8" font-family="Arial, sans-serif" font-size="11">
      imperative drawing commands.
    </text>
  </g>
  
  <!-- Legend for layer types -->
  <g transform="translate(50, 320)">
    <text x="0" y="0" fill="#888" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Layer Types:</text>
    <rect x="0" y="10" width="12" height="12" fill="#0072B2"/>
    <text x="18" y="20" fill="#AAA" font-family="Arial, sans-serif" font-size="10">Required</text>
    <rect x="75" y="10" width="12" height="12" fill="#56B4E9"/>
    <text x="93" y="20" fill="#AAA" font-family="Arial, sans-serif" font-size="10">Optional</text>
    <rect x="150" y="10" width="12" height="12" fill="#F0E442"/>
    <text x="168" y="20" fill="#AAA" font-family="Arial, sans-serif" font-size="10">Styling</text>
  </g>
  
  <!-- Copyright -->
  <text x="450" y="580" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="10">
    © 2025 Antonio Clim. All rights reserved. Week 6: Visualisation for Research
  </text>
</svg>
